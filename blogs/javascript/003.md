---
title: Number类型
date: 2022-8-16
categories: 
 - JavaScript
tags:
 - JavaScript
sidebar: 'auto'
---

## 介绍

两种：整形数据、浮点型数据

整形数据：十进制（偶尔八进制、十六进制）

1. 八进制（首位0，其他位0-7[大于7无效 十进制处理]）
```js
var num1 = 024; // 2 * 8 + 4
var num2 = 079; // 79
```

2. 十六进制（前两位0x，其他位（0-9，a-f || A-F，超过范围异常））
```js
var num3 = 0x3f; // 3 * 16 + 15 = 63
var num4 = 0x2g; // Error
```

## 类型转换
(1) Boolean => Number
true => 1
false => 0

(2) Null => Number
Null => 0

(3) Undefined => Number
undefined => NaN

(4) String => Number
1.只包含数字 => 十进制，前面有0，省略（"0123" => 123）
2.有效浮点数 => 十进制 "1.23" => 1.23
3.有效十六进制 => 十进制 "0x3f" => 3 * 16 + 15 = 63
4.空字符串 => 0
5.除以上 => NaN

(5) Object => Number
1.调用valueOf() 2.根据返回值 转换 3.若是NaN,调用toString() 4.根据返回值 转换 5.有Number类型值返回，无NaN

## Number()函数

一、 Number()函数 任何类型 => Number
1. 数字 根据进制 统一转 十进制
```js
Number(10); // 10
Number(010); // 1 * 8 + 0 = 8
Number(0x10); // 1 * 16 + 0 = 16
```

2. Boolean
```js
Number(true); // 1
Number(false); // 0
```

3. null
```js
Number(null); // 0
```

4. undefined
```js
Number(undefined); // NaN
```

5. 字符串
数字
```js
Number('21'); // 21 十进制处理
Number('021'); // 21 前面0忽略
```

浮点数 => 浮点数（前置0只留1个）
```js
Number('0.12'); // 0.12
Number('00.12'); // 0.12
```

十六进制 => 十进制；八进制 直接 十进制输出 （前置0忽略）
```js
Number('0x12'); // 1 * 16 + 2 = 18
Number('0x21'); // 2 * 16 + 1 = 33
Number('010'); // 10
Number('0010'); // 10
```

为空 || 连续多个空格 => 0
```js
Number(''); // 0
Number('  '); // 0
```

除以上情况 => NaN
```js
Number('123a'); // NaN
Number('a1.1.abc'); // NaN
```

对象类型 调用valueOf() 获取返回值 转Number；不满足 调用toString() 获取返回值 转Number；不满足 NaN
```js
var obj = {
    age: 21,
    valueOf: function () {
        return this.age;
    },
    toString: function () {
        return 'good';
    }
}

Number(obj); // 21
```
通过toString() 转 Number
```js
var obj = {
    age: '21',
    valueOf: function () {
        return [];
    },
    toString: function () {
        return this.age;
    }
}

Number(obj); // 21
```
valueOf()、toString() 转不成 Number类型 返回 NaN
```js
var obj = {
    age: '21',
    valueOf: function () {
        return 'a';
    },
    toString: function () {
        return 'b';
    }
}

Number(obj); // NaN
```
valueOf()、toString() 返回对象类型 抛出异常
```js
var obj = {
    age: '21',
    valueOf: function () {
        return [];
    },
    toString: function () {
        return [];
    }
};

Number(obj); // error
```

## parseInt()函数

解析字符串 返回 指定基数对应的整数值；若字符串无法转换Number 返回 NaN

格式：parseInt(string, radix); 

string：被解析的值 若不是字符串 调用toString() 转换 字符串（有空白符忽略）
radix：进制转换基数（2~36进制），默认10进制，建议都写上该参数

字符串 => 整数 注意：

1. 非字符串（包括：整数）=> 字符串
```js
parseInt('0x12', 16); // 1 * 16 + 2 = 18
parseInt(0x12, 16); // 传入十六进制数 先转十进制数 为 18 再转为字符串 '18' 最后转为十六进制数 1 * 16 + 8 = 24
```

2. 数据截取前置匹配原则
从字符串第一个字符开始匹配，处于基数指定范围，保留并往后匹配，若某个字符不符合（舍弃后面所有 包括该字符），符合条件字符 => 整数
```js
parseInt("fg123", 16); // 15
parseInt("0x12", 16); // 1 * 16 + 2 = 18
parseInt("0x12", 10); // 0
parseInt(15 * 3, 10); // 先运算 45 再进行 parseInt(45, 10)
parseInt('15 * 3', 10); // 15 字符串处理 不进行运算
```

3.浮点型数 处理
浮点型数 忽略小数点及后面数 直接取整
```js
parseInt('6.01', 10); // 6
```
全部返回 15
```js
parseInt("0xF", 16); // 15
parseInt("F", 16); // 15
parseInt("17", 8); // 15
parseInt(021, 8); // 15
parseInt("015", 10); // 15
parseInt(15.99, 10); // 15
parseInt("15,123", 10); // 15
parseInt("FXX123", 16); // 15
parseInt("1111", 2); // 1 * 2的三次方 + 1 * 2的二次方 + 1 * 2 + 1 = 15
parseInt("15 * 3", 10); // 15
parseInt("15px", 10); // 15
parseInt("12", 13); // 15
```

## map()与parseInt()的隐形坑

题：存在一个数组，数组每个元素是Number类型字符串['1', '2', '3', '4']，如何将数组元素全转为整数？

第一：可能会想 用Array的map()中调用parseInt()函数
```js
var arr = ['1', '2', '3', '4'];
var result = arr.map(parseInt);
console.log(result); // [1, NaN, NaN, NaN, NaN]

// 隐形坑导致
// 上面缩写实际为
arr.map(function (val, index) {
    return parseInt(val, index);
});

// parseInt() 第二个参数 实际为 数组索引值
parseInt('1', 0); // 1 任何整数以0为基数取整 返回本身
parseInt('2', 1); // NaN 基数范围2~36，不满足
parseInt('3', 2); // NaN 二进制只有0和1 3 超出范围
parseInt('4', 3); // NaN 4无法用三进制表示
```
这里不能直接将parseInt()作为map()的参数，而是在map()的回调函数中使用，尽量指定基数
```js
var arr = ['1', '2', '3', '4'];

var result = arr.map(function (val) {
    return parseInt(val, 10);
});

console.log(result); // [1,2,3,4]
```

## parseFloat()函数

解析字符串 返回浮点数，不能转换为数值 NaN；没有进制

注意：
1. 遇到除正负号、0~9、小数点、科学计数法以外字符，忽略所有字符（从该字符开始），返回已解析的

2. 正负号必须在第一位，不能连续
```js
parseFloat('+1.2'); // 1.2
parseFloat('-1.2'); // -1.2
parseFloat('++1.2'); // NaN
parseFloat('--1.2'); // NaN
parseFloat('1+1.2'); // 1  +不当符号位
```

3. 空白符忽略，第一个字符无法解析 => NaN
```js
parseFloat(' 1.2'); // 1.2
parseFloat('f1.2'); // NaN
```

4.小数点只能匹配第一个，第二个无效（忽略后面的）
```js
parseFloat('11.20'); // 11.2
parseFloat('11.2.1'); // 11.2
```

综合示例：
```js
parseFloat("123AF"); // 123
parseFloat("0xA"); // 0
parseFloat("0908.5"); // 908.5
```

